import{r as d,j as t,a as m}from"./index-DGmgK9my.js";import{s as i}from"./supabaseClient-BZKDZ21_.js";const h=()=>({signup:async(e,r)=>{const{error:a}=await i.auth.signUp({email:e,password:r});if(a)throw a},login:async(e,r)=>{const{error:a}=await i.auth.signInWithPassword({email:e,password:r});if(a)throw a},logout:async()=>{const{error:e}=await i.auth.signOut();if(e)throw e}}),p=()=>{const{login:g,logout:l}=h(),[o,e]=d.useState(""),[r,a]=d.useState(""),u=async s=>{s.preventDefault();try{await g(o,r),alert("Login successful!")}catch(n){console.error(n)}};return t.jsxs("div",{children:[t.jsxs("form",{onSubmit:u,children:[t.jsx("input",{type:"email",value:o,onChange:s=>e(s.target.value),placeholder:"Email"}),t.jsx("input",{type:"password",value:r,onChange:s=>a(s.target.value),placeholder:"Password"}),t.jsx("button",{type:"submit",children:"Login"})]}),t.jsx("button",{onClick:l,children:"Logout"})]})},f=()=>({uploadImage:async l=>{var n,c;const o=await i.auth.getUser();if(!o.data)throw new Error("User not authenticated");const{data:e,error:r}=await i.storage.from("mosque-images").upload(`${(n=o.data.user)==null?void 0:n.id}/${l.name}`,l,{cacheControl:"3600",upsert:!1});if(r)throw r;const{data:a}=i.storage.from("mosque-images").getPublicUrl((e==null?void 0:e.path)||"");if(!a)throw new Error("Unable to get the public URL");const u=a.publicUrl,{error:s}=await i.from("mosque_images").insert({user_id:(c=o.data.user)==null?void 0:c.id,image_url:u});if(s)throw s;return u}}),w=()=>{const{uploadImage:g}=f(),[l,o]=d.useState(null),e=m(),[r,a]=d.useState(null),u=()=>{e("/portofolio-burhan/imggallery")},s=async n=>{if(n.preventDefault(),!!l)try{const c=await g(l);a(c),alert("Image uploaded successfully!"),e("/portofolio-burhan/imggallery")}catch(c){console.error(c)}};return t.jsxs(t.Fragment,{children:[t.jsxs("form",{onSubmit:s,children:[t.jsx("input",{type:"file",onChange:n=>o(n.target.files?n.target.files[0]:null)}),t.jsx("button",{type:"submit",children:"Upload Image"})]}),t.jsx("button",{onClick:u,children:"Gallery"}),r&&t.jsx("img",{src:r,alt:"Uploaded"})]})},j=()=>t.jsxs("div",{children:[t.jsx("h1",{children:"Secure App"}),t.jsx(p,{}),t.jsx(w,{})]});export{j as default};
